<div class="panel panel-default">
	<div class="panel-heading">
		Notifications: {{ taskNotifications.task.name }} <em class="small">{{ taskNotifications.task.currentStatusTitle }}</em>
	</div>

	<div class="panel-body">

		<ul class="nav nav-pills nav-justified" ng-init="form.curTab = 'Recipients'">
			<li role="presentation" ng-class="{'active':form.curTab === 'Recipients'}"><a href ng-click="form.curTab = 'Recipients'">Recipients <span title="Receiving Digital">({{ form.recipEmail || 0 }})</span> <span title="Receiving Traditional Mail">({{ form.recipMail || 0}})</span></a></li>
			<li role="presentation" ng-class="{'active':form.curTab === 'Content'}"><a href ng-click="form.curTab = 'Content'">Content</a></li>
			<li role="presentation" ng-class="{'active':form.curTab === 'Schedule'}"><a href ng-click="form.curTab = 'Schedule'">Schedule</a></li>
		</ul>

		<div ng-show="form.curTab === 'Recipients'">
		<hr/>
			<!-- Recipients -->
			<div class="row">
				<div class="col-sm-12 text-right small">
					<a href x-modal-select-users x-users="taskNotifications.customRecipients" x-project="taskNotifications.project">Add Recipients</a>
				</div>
			</div>
			<div class="row" ng-repeat="(role, list) in taskNotifications.recipients">
				<div class="col-sm-6">
					<label class="control-label">{{ role }} By Email</label>
					<div class="well well-sm">
						<ul class="list-unstyled">
							<li ng-repeat="user in list.viaEmail" ng-init="form.recipEmail = (form.recipEmail + 1)">
								{{ user.name }} <em class="small">{{ user.role }}</em>
							</li>
							<li ng-if="list.viaEmail.length === 0" class="small">
								<em>None</em>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-sm-6">
					<label class="control-label">{{ role }} By Traditional Mail</label>
					<div class="well well-sm">
						<ul class="list-unstyled">
							<li ng-repeat="user in list.viaMail" ng-init="form.recipMail = (form.recipMail + 1)">
								{{ user.name }} <em class="small">{{ user.role }}</em>
							</li>
							<li ng-if="list.viaMail.length === 0" class="small">
								<em>None</em>
							</li>
						</ul>
					</div>
				</div>	
			</div>
			
		</div>


		<div ng-show="form.curTab === 'Content'">
			<hr/>
			<div class="row">
				<div class="col-sm-9">
					<div class="form-inline form-group">
						<label class="control-label" for="template">Template</label>
						<select type="text" id="template" class="form-control" ng-options="tmp as tmp.name for tmp in taskNotifications.templates track by tmp.code" ng-change="taskNotifications.setContent()" ng-model="taskNotifications.selectedTemplate"></select>
					</div>
					<textarea rows="10" ng-model="taskNotifications.mailContent" class="form-control"></textarea>
				</div>
				<div class="col-sm-3">
					<label class="control-label">Attachments</label>
					<div class="well well-sm">
						<tmpl-requirements-checklist x-project="taskNotifications.project" x-required="taskNotifications.selectedTemplate.requirements"></tmpl-requirements-checklist>
					</div>
				</div>
			</div>
		</div>

		<div ng-show="form.curTab === 'Schedule'">
		<hr/>
			<div class="row">
				<div class="col-sm-8 col-sm-offset-2 col-lg-4 col-lg-offset-4">
					<div class="form-group">
						<label class="control-label" for="scheduledDate">Send On</label>
						<input type="datetime" id="scheduledDate" class="form-control text-center" ng-model="taskNotifications.dateQueued"/>
					</div>
					<div class="well well-sm text-center">
						<datetimepicker ng-model="taskNotifications.dateQueued" data-datetimepicker-config="{}"/>
					</div>
				</div>
			</div>

		</div>
	</div>
	<div class="panel-footer text-right">
		<a class="btn btn-success" href ng-show="form.curTab === 'Recipients'" ng-click="form.curTab = 'Content'">Next</a>
		<a class="btn btn-success" href ng-show="form.curTab === 'Content'" ng-click="form.curTab = 'Schedule'">Next</a>
		<a class="btn btn-success" href ng-show="form.curTab === 'Schedule'">Complete</a>
	</div>
</div>
